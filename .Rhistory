getwd()
setwd(".")
getwd()
---
len(7FD3D3D3)
length("7FD3D3D3")
len("7FD3D3D3")
length("7,F,D,3,D,3,D,3")
library(ggmap)
library(ggplot2)
library(dplyr)
setwd(".")
data <- read.csv("daily_entries_exits.csv")
setwd("~/subway")
library(ggmap)
library(ggplot2)
library(dplyr)
setwd(".")
data <- read.csv("daily_entries_exits.csv")
View(data)
View(data)
?max
max(data$entries)
m <- data %>% filter(entries = max(data$entries))
m <- data %>% filter(entries == max(data$entries))
View(m)
m <- data %>% filter(entries > 100000))
m <- data %>% filter(entries > 10000))
colnames(data)[5] <- "entries"
colnames(data)[6] <- "exits"
m <- data %>% filter(entries > 10000))
m <- data %>% filter(entries > 10000)
View(m)
View(data)
View(data)
Pabt <- data %>% filter(station_id == "s1014")
View(Pabt)
Pabt <- data %>% filter(station_id == "s1014", date="10/11/2014")
Pabt <- data %>% filter(station_id == "s1014", date=="10/11/2014")
View(Pabt)
Pabt <- data %>% filter(station_id == "s1014")
Pabt <- data %>% filter(date="10/11/2014")
Pabt <- data %>% filter(date=="10/11/2014")
View(Pabt)
Eleventh <- data %>% filter(date=="10/11/2014")
sum(Eleventh$entries)
library(dplyr)
library(timeDate)
library(reshape)
library(ggplot2)
library(data.table)
library(tidyr)
library(scales)
#?
#library(GISTools)
setwd(".")
subwaydata <- read.csv("all_ts.csv", stringsAsFactors = FALSE)  # read csv file
#SAMPLE!!
subwaydata <- sample_n(subwaydata, (nrow(subwaydata)/4))
# creating dataframe with num_entries, num_exits, and time difference
names(subwaydata) <- tolower(names(subwaydata))
subwaydata$date.time <- with(subwaydata, paste(date, time, sep=' '))
subwaydata$date.time <- with(subwaydata, strptime(date.time, "%m/%d/%Y %H:%M:%S"))
subwaydata$date.time <- with(subwaydata, as.POSIXct((date.time)))
#Might need to re-add those to make the lines.
subwaydata <- as.data.frame(subwaydata) %>%select(-x)
View(subwaydata)
teneleven <- subwaydata %>% filter(date = "10/11/2014")
teneleven <- subwaydata %>% filter(date == "10/11/2014")
View(teneleven)
subwaydata <- as.data.frame(subwaydata) %>%select(-x, -intersect)
setwd(".")
subwaydata <- read.csv("all_ts.csv", stringsAsFactors = FALSE)  # read csv file
#SAMPLE!!
subwaydata <- sample_n(subwaydata, (nrow(subwaydata)/4))
# creating dataframe with num_entries, num_exits, and time difference
names(subwaydata) <- tolower(names(subwaydata))
subwaydata$date.time <- with(subwaydata, paste(date, time, sep=' '))
subwaydata$date.time <- with(subwaydata, strptime(date.time, "%m/%d/%Y %H:%M:%S"))
subwaydata$date.time <- with(subwaydata, as.POSIXct((date.time)))
subwaydata <- as.data.frame(subwaydata) %>%select(-x, -intersect)
teneleven <- subwaydata %>% filter(date == "10/11/2014")
View(teneleven)
teneleven <- teneleven %>% arrange(station_id)
View(teneleven)
teneleven <- teneleven %>% group_by(c.a, unit, scp) %>% arrange(station_id)
View(teneleven)
teneleven <- teneleven %>% group_by(c.a, unit, scp) %>% arrange(c.am unit, scp, station_id)
teneleven <- teneleven %>% group_by(c.a, unit, scp) %>% arrange(c.a, unit, scp, station_id)
View(teneleven)
teneleven <- teneleven %>% group_by(c.a, unit, scp) %>% arrange(station_id, c.a, unit, scp)
View(teneleven)
teneleven <- arrange(teneleven, date.time) %>%
mutate(time.delta = as.numeric(date.time-lag(date.time),units="hours")
)
View(teneleven)
mutate(lasttime = as.numeric(lag(date.time)), time.delta = as.numeric(date.time-lag(date.time),units="hours"))
teneleven <- arrange(teneleven, date.time) %>%
mutate(lasttime = as.numeric(lag(date.time)), time.delta = as.numeric(date.time-lag(date.time),units="hours"))
View(teneleven)
teneleven <- arrange(teneleven, date.time) %>%
mutate(lasttime = lag(date.time), time.delta = as.numeric(date.time-lag(date.time),units="hours"))
teneleven <- arrange(teneleven, c.a, unit, scp, station, linename, date.time)
teneleven <-teneleven %>%
mutate(entry_exits_period = as.character(ifelse(time > "0:00:00" & time <= "04:00:00", as.character("0:4"),
ifelse(time > "04:00:00" & time <= "08:00:00", "4:8",
ifelse(time > "08:00:00" & time <= "12:00:00", "8:12",
ifelse(time > "12:00:00" & time <= "16:00:00", "12:16",
ifelse(time > "16:00:00" & time <= "20:00:00", "16:20", "20:0")))))))
View(teneleven)
teneleven <- subwaydata # %>% filter(date == "10/11/2014")
teneleven <- teneleven %>% group_by(c.a, unit, scp) %>% arrange(station_id, c.a, unit, scp)
teneleven <- arrange(teneleven, date.time) %>%
mutate(lasttime = lag(date.time), time.delta = as.numeric(date.time-lag(date.time),units="hours"))
teneleven <- arrange(teneleven, c.a, unit, scp, station, linename, date.time)
teneleven <-teneleven %>%
mutate(entry_exits_period = as.character(ifelse(time > "0:00:00" & time <= "04:00:00", as.character("0:4"),
ifelse(time > "04:00:00" & time <= "08:00:00", "4:8",
ifelse(time > "08:00:00" & time <= "12:00:00", "8:12",
ifelse(time > "12:00:00" & time <= "16:00:00", "12:16",
ifelse(time > "16:00:00" & time <= "20:00:00", "16:20", "20:0")))))))
View(teneleven)
teneleven <- teneleven %>% mutate(entries.delta = entries - lag(entries))
View(teneleven)
21886 - 21950
21934 - 21886
teneleven <- teneleven %>% group_by(teneleven, c.a, unit, scp, station_id, date.time) %>% arrange()
teneleven <- teneleven %>% group_by(c.a, unit, scp, station_id, date.time) %>% arrange()
View(teneleven)
teneleven <- teneleven %>% group_by(entry_exits_period, c.a, unit, scp, station_id, date.time) %>% arrange()
View(teneleven)
teneleven <- teneleven %>% group_by(entry_exits_period, station_id, date.time) %>% arrange()
View(teneleven)
teneleven <- ungroup(teneleven)
teneleven <- teneleven %>% group_by(entry_exits_period, station_id, date.time) %>% arrange()
View(teneleven)
teneleven <- teneleven %>% group_by(station_id, date.time, entry_exits_period) %>% arrange()
View(teneleven)
teneleven <- teneleven %>% group_by(entry_exits_period) %>% arrange()
View(teneleven)
teneleven <- teneleven %>% group_by(station_id, date.time, entry_exits_period) %>% arrange(entry_exits_period)
View(teneleven)
teneleven <- teneleven %>% group_by(station_id, date.time, entry_exits_period) %>% arrange(station_id, date.time, entry_exits_period)
View(teneleven)
teneleven <- teneleven %>% group_by(station_id, date, time, entry_exits_period) %>% arrange(station_id, entry_exits_period)
View(teneleven)
teneleven <- teneleven %>% group_by(station_id, date, entry_exits_period) %>% arrange(station_id, entry_exits_period)
teneleven <- teneleven %>% group_by(station_id, date, entry_exits_period) %>% arrange(station_id, date, entry_exits_period)
View(teneleven)
tentwelve <- summarize(teneleven, st.entries = sum(entries.delta))
View(tentwelve)
?sum
tentwelve <- summarize(teneleven, st.entries = sum(entries.delta, na.rm = TRUE))
View(tentwelve)
teneleven <- teneleven %>% group_by(station, station_id, date, entry_exits_period) %>% arrange(station, station_id, date, entry_exits_period)
tentwelve <- summarize(teneleven, st.entries = sum(entries.delta, na.rm = TRUE))
View(tentwelve)
teneleven <- teneleven %>% group_by(station_id, date, entry_exits_period) %>% arrange(station, station_id, date, entry_exits_period)
teneleven <- teneleven %>% group_by(station_id, date, entry_exits_period) %>% arrange(station_id, date, entry_exits_period)
tentwelve <- summarize(teneleven, st.entries = sum(entries.delta, na.rm = TRUE))
View(tentwelve)
teneleven <- subwaydata # %>% filter(date == "10/11/2014")
teneleven <- teneleven %>% group_by(c.a, unit, scp) %>% arrange(station_id, c.a, unit, scp)
teneleven <- arrange(teneleven, date.time) %>%
mutate(lasttime = lag(date.time), time.delta = as.numeric(date.time-lag(date.time),units="hours"))
teneleven <- arrange(teneleven, c.a, unit, scp, station, linename, date.time)
teneleven <-teneleven %>%
mutate(entry_exits_period = as.character(ifelse(time > "0:00:00" & time <= "04:00:00", as.character("0:4"),
ifelse(time > "04:00:00" & time <= "08:00:00", "4:8",
ifelse(time > "08:00:00" & time <= "12:00:00", "8:12",
ifelse(time > "12:00:00" & time <= "16:00:00", "12:16",
ifelse(time > "16:00:00" & time <= "20:00:00", "16:20", "20:0")))))))
teneleven <- teneleven %>% mutate(entries.delta = entries - lag(entries), exits.delta = exits - lag(exits))
teneleven <- ungroup(teneleven)
teneleven <- teneleven %>% group_by(station_id, date, entry_exits_period) %>% arrange(station_id, date, entry_exits_period)
tentwelve <- summarize(teneleven, st.entries = sum(entries.delta, na.rm = TRUE), st.exits = sum(exits.delta, na.rm = TRUE))
View(tentwelve)
View(tentwelve)
View(tentwelve)
subwaydata <- subwaydata %>%
filter(st.entries < 75000) %>%
filter(st.exits < 75000) %>%
filter(st.exits > -1) %>%
filter(st.entries > -1)
tentwelve <- tentwelve %>%
filter(st.entries < 75000) %>%
filter(st.exits < 75000) %>%
filter(st.exits > -1) %>%
filter(st.entries > -1)
View(tentwelve)
tentwelve <- mutate(tentwelve, day_of_week = dayOfWeek(as.Date(date)))
View(tentwelve)
