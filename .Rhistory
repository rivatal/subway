getwd()
setwd(".")
getwd()
library(dplyr)
library(timeDate)
library(reshape)
library(ggplot2)
library(data.table)
library(tidyr)
library(scales)
#?
#library(GISTools)
setwd(".")
subwaydata <- read.csv("sample_ts.csv", stringsAsFactors = FALSE)  # read csv file
# creating dataframe with num_entries, num_exits, and time difference
names(subwaydata) <- tolower(names(subwaydata))
subwaydata$date.time <- with(subwaydata, paste(date, time, sep=' '))
subwaydata$date.time <- with(subwaydata, strptime(date.time, "%m/%d/%Y %H:%M:%S"))
subwaydata$date.time <- with(subwaydata, as.POSIXct((date.time)))
library(dplyr)
library(timeDate)
library(reshape)
library(ggplot2)
library(data.table)
library(tidyr)
library(scales)
#?
#library(GISTools)
setwd(".")
subwaydata <- read.csv("sample_ts.csv", stringsAsFactors = FALSE)  # read csv file
setwd("~/subway")
library(dplyr)
library(timeDate)
library(reshape)
library(ggplot2)
library(data.table)
library(tidyr)
library(scales)
#?
#library(GISTools)
setwd(".")
subwaydata <- read.csv("sample_ts.csv", stringsAsFactors = FALSE)  # read csv file
names(subwaydata) <- tolower(names(subwaydata))
subwaydata$date.time <- with(subwaydata, paste(date, time, sep=' '))
subwaydata$date.time <- with(subwaydata, strptime(date.time, "%m/%d/%Y %H:%M:%S"))
subwaydata$date.time <- with(subwaydata, as.POSIXct((date.time)))
subwaydata <- as.data.frame(subwaydata) %>%select(-gtfs_route) # drop incomplete gtfs routes
subwaydata <- group_by(subwaydata, c.a, unit, scp, station, linename) # select unique turnstiles for each station
View(subwaydata)
subwaydata <- arrange(subwaydata, date.time) %>%
mutate(time.delta = as.numeric(date.time-lag(date.time),units="hours"),
entries.delta = entries - lag(entries),
exits.delta = exits - lag(exits),
day_of_week = dayOfWeek(as.timeDate(date)))
View(subwaydata)
subwaydata <- group_by(subwaydata, c.a, unit, scp, station, linename) # select unique turnstiles for each station
subwaydata <- arrange(subwaydata, date.time) %>%
mutate(time.delta = as.numeric(lag(date.time),units="hours"),
entries.delta = lag(entries),
exits.delta = lag(exits),
day_of_week = dayOfWeek(as.timeDate(date)))
View(subwaydata)
setwd(".")
subwaydata <- read.csv("sample_ts.csv", stringsAsFactors = FALSE)  # read csv file
# creating dataframe with num_entries, num_exits, and time difference
names(subwaydata) <- tolower(names(subwaydata))
subwaydata$date.time <- with(subwaydata, paste(date, time, sep=' '))
subwaydata$date.time <- with(subwaydata, strptime(date.time, "%m/%d/%Y %H:%M:%S"))
subwaydata$date.time <- with(subwaydata, as.POSIXct((date.time)))
#Might need to re-add those to make the lines.
subwaydata <- as.data.frame(subwaydata) %>%select(-gtfs_route, -X) # drop incomplete gtfs routes
subwaydata <- as.data.frame(subwaydata) %>%select(-gtfs_route, -x) # drop incomplete gtfs routes
subwaydata <- subwaydata[!duplicated(subwaydata),]
subwaydata <- group_by(subwaydata, c.a, unit, scp, station, linename) # select unique turnstiles for each station
subwaydata <- arrange(subwaydata, date.time) %>%
mutate(time.delta = as.numeric(lag(date.time),units="hours"),
entries.delta = lag(entries),
exits.delta = lag(exits),
day_of_week = dayOfWeek(as.timeDate(date)))
View(subwaydata)
subwaydata <- arrange(subwaydata, date.time) %>%
mutate(time.delta = as.numeric(lag(date.time),units="hours"),
entries.delta = lag(entries),
exits.delta = lag(exits),
day_of_week = dayOfWeek(as.timeDate(date)))
subwaydata <- arrange(subwaydata, date.time) %>%
mutate(time.delta = as.numeric(Lag(date.time),units="hours"),
entries.delta = Lag(entries),
exits.delta = lag(exits),
day_of_week = dayOfWeek(as.timeDate(date)))
subwaydata <- group_by(subwaydata, c.a, unit, scp, station, linename) # select unique turnstiles for each station
subwaydata <- arrange(subwaydata, date.time) %>%
mutate(time.delta = as.numeric(lag(date.time),units="hours"),
entries.delta = sum(diff(entries)),
exits.delta = lag(exits),
day_of_week = dayOfWeek(as.timeDate(date)))
View(subwaydata)
2788548
-
2788548 - 1805961
subwaydata <- arrange(subwaydata, date.time) %>%
mutate(time.delta = as.numeric(lag(date.time),units="hours")
)
subwaydata <- arrange(subwaydata, date.time) %>%
mutate(time.delta = as.numeric(lag(date.time),units="hours")),
subwaydata <- arrange(subwaydata, date.time) %>%
mutate(time.delta = as.numeric(lag(date.time),units="hours"))
subwaydata <- arrange(subwaydata, date.time) %>%
mutate(time.delta = as.numeric(lag(date.time),units="hours"))
subwaydata <- arrange(subwaydata, date.time) %>%
mutate(time.delta = as.numeric(lag(date.time),units="hours")) %>% group_by(subwaydata, c.a, unit, scp, station, linename, time.delta)
%>% summarize(entries.delta = cumsum(entries))
subwaydata <- arrange(subwaydata, date.time) %>%
mutate(time.delta = as.numeric(lag(date.time),units="hours")) %>% group_by(subwaydata, c.a, unit, scp, station, linename, time.delta)     %>%
summarize(entries.delta = cumsum(entries))
subwaydata <- arrange(subwaydata, date.time) %>%
mutate(time.delta = as.numeric(lag(date.time),units="hours")) %>% group_by(c.a, unit, scp, station, linename, time.delta)     %>%
summarize(entries.delta = cumsum(entries))
subwaydata <- arrange(subwaydata, date.time) %>%
mutate(time.delta = as.numeric(lag(date.time),units="hours")) %>% group_by(c.a, unit, scp, station, linename, time.delta) %>%
summarize(entries.delta = cumsum(entries))
subwaydata <- arrange(subwaydata, date.time) %>%
mutate(time.delta = as.numeric(lag(date.time),units="hours")) %>% group_by(c.a, unit, scp, station, linename, time.delta) %>%
summarize(entries.delta = sum(entries))
warnings()
subwaydata <- arrange(subwaydata, date.time) %>%
mutate(time.delta = as.numeric(lag(date.time),units="hours")) %>% group_by(c.a, unit, scp, station, linename, time.delta) %>%
summarize(entries.delta = sum(as.numeric(entries)))
View(subwaydata)
